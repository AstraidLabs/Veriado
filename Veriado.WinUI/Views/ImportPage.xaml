<?xml version="1.0" encoding="utf-8"?>
<Page
    x:Class="Veriado.Views.ImportPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:i="using:Microsoft.Xaml.Interactivity"
    xmlns:core="using:Microsoft.Xaml.Interactions.Core"
    xmlns:ctb="using:CommunityToolkit.WinUI.Behaviors"
    xmlns:trig="using:CommunityToolkit.WinUI.Triggers"
    xmlns:vm="using:Veriado.ViewModels.Import"
    x:DataType="vm:ImportViewModel">

  <i:Interaction.Behaviors>
    <core:EventTriggerBehavior EventName="Loaded">
      <core:CallMethodAction MethodName="Focus" TargetObject="{Binding ElementName=StartButton}" />
    </core:EventTriggerBehavior>
  </i:Interaction.Behaviors>

  <Grid Padding="24" RowSpacing="16">
    <StackPanel Spacing="12">
      <TextBlock Text="Import souborů" Style="{StaticResource SectionTitleTextBlockStyle}" />
      <ProgressBar Value="{Binding Progress}" Maximum="100" />
      <StackPanel Orientation="Horizontal" Spacing="12">
        <Button x:Name="StartButton" Content="Spustit import" Command="{Binding StartImportCommand}" />
        <Button Content="Reset" Command="{Binding ResetCommand}" />
      </StackPanel>
      <InfoBar
          IsOpen="True"
          Severity="{Binding HasError, Converter={StaticResource BoolToSeverityConverter}}"
          Title="Stav">
        <StackPanel>
          <TextBlock x:Name="StatusMessageText" Text="{Binding StatusMessage}" />
        </StackPanel>
      </InfoBar>
    </StackPanel>

    <VisualStateManager.VisualStateGroups>
      <VisualStateGroup>
        <VisualState x:Name="Completed">
          <VisualState.StateTriggers>
            <trig:ComparisonStateTrigger Comparison="GreaterThanOrEqual" Value="100" Source="{Binding Progress}" />
          </VisualState.StateTriggers>
          <VisualState.Setters>
            <Setter Target="StatusMessageText.Text" Value="Import dokončen." />
          </VisualState.Setters>
        </VisualState>
      </VisualStateGroup>
    </VisualStateManager.VisualStateGroups>
  </Grid>
</Page>
